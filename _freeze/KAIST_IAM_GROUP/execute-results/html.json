{
  "hash": "dc33aaf9adef717d13578f5ebe18e680",
  "result": {
    "markdown": "---\ntitle: \"KAIST IAM Group\"\ndate : last-modified # now\nauthor: \n - name: \"안지석\"\n   affiliation: \"KAIST ITM\"\ntitle-block-banner: true\nformat: \n  html:\n    theme: flatly\n    code-fold: true\n    toc: true\n    toc-depth: 2\n    toc-title: 목차\n    number-sections : true\n    highlight-style: github\n    self-contained: false\nexecute: \n  freeze: true\n---\n\n\n# Core Model Proposal #359: Hydrogen and transportation technology update\n\n## Transportation\n\n-   Natural Gas Vehicles(NGV)\n-   Light-duty vehicles\n    -   지역별로 LDV의 사이즈를 4개씩 구분하였고, 각각의 배터리 용량(kwh poer vehicle) 제시\n    -   BEV battery pack costs는 2020 BNEF EV Outlook에서 가져옴\n    -   cost mark-up??\n    -   Fuel cell stack costs는 [NREL, 2020 Transportation Annual Technology Baseline](https://atb.nrel.gov/transportation/2020/index)에서 가져옴\n\n## transportation_UCD_CORE_CurPol_Korea_Dawoon\n\n-   region : South Korea\n    -   supplysector :\n        -   항공 :\n            -   aviation_intl\n        -   화물 :\n            -   freight\n            -   freight_road\n        -   여객 :\n            -   pass_road\n            -   pass_road_LDV\n            -   pass_road_LDV_4W\n        -   해운 :\n            -   shipping_intl\n    -   energy_final_demand\n        -   항공:\n            -   aviation_intl\n        -   화물:\n            -   freight\n        -   여객:\n            -   pass\n        -   해운:\n            -   shipping_intl\n\n<br>\n\n-   gcam-7의 transportation_UCD_CORE.xml과 비교해보니, supplysector, energy-final-demand의 구성 name은 동일함\n-   The most common failure to run GCAM when double clicking the run-gcam executable script typically relate to Java.\n-   model running 테스트 -\\> `All model periods solved correctly.`\n\n![스크린샷](./img/solved_correctly.png)\n\n-   Model run 결과는 exe - log - main_log.txt 에서 확인 가능\n-   output - queries\n-   ModelInterface - run-model-interface.bat\n\n![Model interface](./img/model_interface.png) \\### transportation\n\n![](./img/modelinterface_trn.png)\n\n# 2023-08-21 meeting with prof.Jeon\n\n-   GCAM7에는 trn_freight_road(트럭)에 hybrid 추가됨. Dawoon 파일에는 hybrid 없음\n-   Created new xml configuration by adding lines\n\n::: callout-note\nfor `<Configuration>` `<Value name = \"transport\">../input/gcamdata/xml/transportation_UCD_SSP1.xml</Value>`\n:::\n\n::: callout-important\n## 분석기간을 2100년이 아닌 2050년까지만 보고싶은데;;; 오류남.\n\nfor stop year `<Value name=\"stop-year\">2050</Value>` -\\> DOESN'T WORK!!!\n:::\n\n-   Saved as `configuration_transportation_SSP1.xml` for backup\n\n-   Again, saved it as `configuration.xlm` cause `run-batct.cat` in exe folder take `configuration.xlm`(not configuration_transporation_SSP1.xml) as input file\n\n-   run model ![model](./img/model_solved.png)\n\n-   for checking model results, go to Modelinterface folder, and click `run-model-interface.bat` and File - Open -DB Open\n\n![model run result](./img/model_interface_2.png)\n\n-   configuration.xml 파일에 `vale name = solver` 밑에 새로운 `value name = transport` 추가\n\n![](./img/value_name.png)\n\n\n::: {.cell}\n\n:::\n\n\n# 2023-08-22\n\n### git bash or tortoiseGit?\n\n-   Instead of using `tortoiseGit`, I hope to use `git bash`. Running `tortoise git` takes quite a long time when targeted `.xml` files are heavy. For using, CLI(Command line interface) needs to be learned. But, steep learning curve :(\n\n### git diff\n\nShow changes between commits, commit and working tree, etc\n\n-   Tried to use `git diff` to see difference between versions in a file.\n    1.  moved `transportation_UCD_CORE.xml` into a test folder\n\n    2.  modified a `speed` in 2020 from 450 to 500 for make a difference. and then saved it.\n\n![](./img/diff_test.png)\n\n3.  Result. We can find a difference without add or commit. just typing `git diff` gives the difference.\n\n![](./img/diff_test_result.png)\n\n4.Modified `speed` in 2030, 2035 and typed `git diff` again. Same as 2.\n\n![](./img/git_diff_result2.png)\n\n5.  Commit `git commit` and track my log using `git log`\n\n![](./img/git_log.png)\n\n6.  what's next? reset? revert?\n\n-   DAC file\n\n# 2023-08-29\n\n-   수송분야 transport.configuration_transportation_dawoon.xml\n\n## Representation of H2 in GCAM\n\n-   Tried to make a flow chart of hydrogen in GCAM using `mermaid`\n\n::: column-page\n\n```{mermaid}\nflowchart TD\n  Electricity --> H2centralproduction\n  Electricity --> H2wholesaledispensing\n  Electricity --> H2industrial\n  Wind --> H2centralproduction\n  Solar --> H2centralproduction\n  Coal --> H2centralproduction\n  Nuclear --> H2centralproduction\n  Gas --> H2centralproduction\n  Gas --> H2wholesaledispensing\n  H2centralproduction --> H2deliverytrack\n  H2centralproduction --> H2pipeline\n  H2deliverytrack --> H2wholesaledelivery\n  H2deliverytrack --> H2wholesaledispensing\n  H2pipeline --> H2wholesaledelivery \n  H2pipeline --> H2wholesaledispensing\n  H2wholesaledelivery --> H2rentaldelivery\n  H2wholesaledelivery --> H2industrial\n  H2rentaldelivery --> CommercialBuildings\n  H2rentaldelivery --> ResidentialBuildings\n  H2industrial --> AmmoniaProduction\n  H2industrial --> IronandSteelProduction\n  H2industrial --> IndustrialEnergyUse\n  H2wholesaledispensing --> AgriculturalMachinery\n  H2wholesaledispensing --> ConstruntionEquipment\n  H2wholesaledispensing --> MiningEquipment\n  H2wholesaledispensing --> H2rentaldispensing\n  H2rentaldispensing --> HeavyDutyTrucks\n  H2rentaldispensing --> LightDutyVehicles\n  H2rentaldispensing --> AirTransport\n  H2rentaldispensing --> RailTransport\n  H2rentaldispensing --> ShipTransport\n```\n\n:::\n\n# 2023-08-31\n\n## to do\n\n-   Comparing dac_ssp2 and dac_ssp_x3\n-   `transportation_UCD_CORE.xml` in GCAM7 // `transportation_UCD_CORE_CurPol_KOREA_Dawoon.xml`, `transportation_UCD_CORE_NetZero_KOREA_Dawoon.xml` in GCAM-KAIST2.0\n\n## success\n\n-   discovery of `library(gcamaextractor)`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gcamextractor)\n\ngcamextractor::params # view available parameters\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  [1] \"agProdBiomass\"                         \n  [2] \"agProdByCrop\"                          \n  [3] \"agProdbyIrrRfd\"                        \n  [4] \"agProdForest\"                          \n  [5] \"buildingFloorspace\"                    \n  [6] \"co2SequestrationBySector\"              \n  [7] \"elec_cap_usa_GW\"                       \n  [8] \"elec_capacity_factor_usa_in\"           \n  [9] \"elec_carbon_capture_escl_rate_fraction\"\n [10] \"elec_carbon_capture_rate_fraction\"     \n [11] \"elec_fuel_co2_content_tonsperMBTU\"     \n [12] \"elec_fuel_price_2015USDperMBTU\"        \n [13] \"elec_fuel_price_escl_rate_fraction\"    \n [14] \"elec_heat_rate_BTUperkWh\"              \n [15] \"elec_lifetime_scurve_yr\"               \n [16] \"elec_lifetime_yr\"                      \n [17] \"elec_variable_om_2015USDperMWh\"        \n [18] \"elec_variable_om_escl_rate_fraction\"   \n [19] \"elecByTechTWh\"                         \n [20] \"elecCapByFuel\"                         \n [21] \"elecConsumByDemandSectorTWh\"           \n [22] \"elecFinalByFuelTWh\"                    \n [23] \"elecFinalBySecTWh\"                     \n [24] \"elecLoadBySegmentGW\"                   \n [25] \"emissCO2BySector\"                      \n [26] \"emissCO2BySectorNoBio\"                 \n [27] \"emissCO2CumGlobal2010to2100\"           \n [28] \"emissCO2CumGlobal2010to2100RCP\"        \n [29] \"emissGHGByGasGWPAR5\"                   \n [30] \"emissGHGByGasNoBioGWPAR5\"              \n [31] \"emissGHGByResProdGWPAR5\"               \n [32] \"emissGHGBySectorBuildingsGWPAR5\"       \n [33] \"emissGHGBySectorGWPAR5\"                \n [34] \"emissGHGBySectorIndustryGWPAR5\"        \n [35] \"emissGHGBySectorNoBioGWPAR5\"           \n [36] \"emissGHGBySectorPowerGWPAR5\"           \n [37] \"emissGHGBySectorTransportGWPAR5\"       \n [38] \"emissLUC\"                              \n [39] \"energyFinalByFuelBySectorEJ\"           \n [40] \"energyFinalByFuelBySectorMTOE\"         \n [41] \"energyFinalByFuelBySectorTWh\"          \n [42] \"energyFinalByFuelEJ\"                   \n [43] \"energyFinalByFuelEJNoFeedstock\"        \n [44] \"energyFinalbyFuelMTOE\"                 \n [45] \"energyFinalbyFuelTWh\"                  \n [46] \"energyFinalConsumByIntlShpAvEJ\"        \n [47] \"energyFinalConsumByIntlShpAvMTOE\"      \n [48] \"energyFinalConsumByIntlShpAvTWh\"       \n [49] \"energyFinalConsumBySecEJ\"              \n [50] \"energyFinalConsumBySecEJNoFeedstock\"   \n [51] \"energyFinalConsumBySecMTOE\"            \n [52] \"energyFinalConsumBySecTWh\"             \n [53] \"energyFinalSubsecByFuelBuildEJ\"        \n [54] \"energyFinalSubsecByFuelBuildMTOE\"      \n [55] \"energyFinalSubsecByFuelBuildTWh\"       \n [56] \"energyFinalSubsecByFuelIndusEJ\"        \n [57] \"energyFinalSubsecByFuelIndusMTOE\"      \n [58] \"energyFinalSubsecByFuelIndusTWh\"       \n [59] \"energyFinalSubsecByFuelTranspEJ\"       \n [60] \"energyFinalSubsecByFuelTranspMTOE\"     \n [61] \"energyFinalSubsecByFuelTranspTWh\"      \n [62] \"energyFinalSubsecBySectorBuildEJ\"      \n [63] \"energyFinalSubsecBySectorBuildMTOE\"    \n [64] \"energyFinalSubsecBySectorBuildTWh\"     \n [65] \"energyPrimaryByFuelEJ\"                 \n [66] \"energyPrimaryByFuelMTOE\"               \n [67] \"energyPrimaryByFuelTWh\"                \n [68] \"energyPrimaryRefLiqProdEJ\"             \n [69] \"energyPrimaryRefLiqProdMTOE\"           \n [70] \"energyPrimaryRefLiqProdTWh\"            \n [71] \"fertConsByAgTech\"                      \n [72] \"gdp\"                                   \n [73] \"gdpGrowthRate\"                         \n [74] \"gdpPerCapita\"                          \n [75] \"hydrogenCostsByTech\"                   \n [76] \"hydrogenInputsByTech\"                  \n [77] \"hydrogenOutputsByTech\"                 \n [78] \"hydrogenPricesBySector\"                \n [79] \"hydrogenProdByTech\"                    \n [80] \"hydrogenUtilizationByTech\"             \n [81] \"inputs\"                                \n [82] \"landAlloc\"                             \n [83] \"landAllocByCrop\"                       \n [84] \"landAllocDetail\"                       \n [85] \"landIrrCrop\"                           \n [86] \"landIrrRfd\"                            \n [87] \"landRfdCrop\"                           \n [88] \"livestock_MeatDairybySubsector\"        \n [89] \"livestock_MeatDairybyTechImports\"      \n [90] \"livestock_MeatDairybyTechMixed\"        \n [91] \"livestock_MeatDairybyTechPastoral\"     \n [92] \"outputs\"                               \n [93] \"pop\"                                   \n [94] \"serviceOutputByTechBuildings\"          \n [95] \"transportFreightGHGByMode\"             \n [96] \"transportFreightVMTByFuel\"             \n [97] \"transportFreightVMTByFuelNew\"          \n [98] \"transportFreightVMTByMode\"             \n [99] \"transportFreightVMTByTech\"             \n[100] \"transportPassengerGHGByMode\"           \n[101] \"transportPassengerVMTByFuel\"           \n[102] \"transportPassengerVMTByFuelNew\"        \n[103] \"transportPassengerVMTByMode\"           \n[104] \"transportPassengerVMTByTech\"           \n[105] \"watBioPhysCons\"                        \n[106] \"watConsumBySec\"                        \n[107] \"waterWithdrawROGW\"                     \n[108] \"watIrrConsBasin\"                       \n[109] \"watIrrWithdrawBasin\"                   \n[110] \"watSupRunoffBasin\"                     \n[111] \"watWithdrawByCrop\"                     \n[112] \"watWithdrawBySec\"                      \n```\n:::\n\n```{.r .cell-code}\ngcamextractor::queries # Get all queries used\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"ag production by tech\"                                     \n [2] \"aggregated land allocation\"                                \n [3] \"Basin level available runoff\"                              \n [4] \"biophysical water demand by crop type and land region\"     \n [5] \"building final energy by fuel\"                             \n [6] \"building final energy by subsector\"                        \n [7] \"building floorspace\"                                       \n [8] \"building service output by tech\"                           \n [9] \"CO2 emissions by sector\"                                   \n[10] \"CO2 emissions by sector\"                                   \n[11] \"CO2 emissions by sector\"                                   \n[12] \"CO2 emissions by sector\"                                   \n[13] \"CO2 emissions by sector\"                                   \n[14] \"CO2 emissions by sector\"                                   \n[15] \"CO2 emissions by sector\"                                   \n[16] \"CO2 emissions by sector (no bio)\"                          \n[17] \"CO2 emissions by sector (no bio)\"                          \n[18] \"CO2 emissions by sector (no bio)\"                          \n[19] \"CO2 emissions by sector (no bio)\"                          \n[20] \"CO2 emissions by sector (no bio)\"                          \n[21] \"CO2 emissions by subsector\"                                \n[22] \"CO2 sequestration by sector\"                               \n[23] \"CO2 sequestration by sector\"                               \n[24] \"CO2 sequestration by sector\"                               \n[25] \"CO2 sequestration by sector\"                               \n[26] \"CO2 sequestration by sector\"                               \n[27] \"CO2 sequestration by sector\"                               \n[28] \"CO2 sequestration by sector\"                               \n[29] \"detailed land allocation\"                                  \n[30] \"elec capacity by tech and vintage\"                         \n[31] \"elec coeff\"                                                \n[32] \"elec consumption by demand sector\"                         \n[33] \"elec gen by gen tech and cooling tech\"                     \n[34] \"elec gen by gen tech cogen USA\"                            \n[35] \"elec gen by gen tech USA\"                                  \n[36] \"elec gen by segment (grid level)\"                          \n[37] \"elec investment capacity factor\"                           \n[38] \"elec operating costs by tech and vintage\"                  \n[39] \"fertilizer consumption by ag tech\"                         \n[40] \"Final energy by detailed end-use sector and fuel\"          \n[41] \"GDP Growth Rate (Percent)\"                                 \n[42] \"GDP MER by region\"                                         \n[43] \"GDP per capita MER by region\"                              \n[44] \"hydrogen costs by tech\"                                    \n[45] \"hydrogen inputs by tech\"                                   \n[46] \"hydrogen outputs by technology\"                            \n[47] \"hydrogen prices by sector\"                                 \n[48] \"hydrogen production by tech\"                               \n[49] \"hydrogen utilization by technology\"                        \n[50] \"industry final energy by fuel\"                             \n[51] \"inputs by tech\"                                            \n[52] \"land allocation by crop\"                                   \n[53] \"land allocation by crop and water source\"                  \n[54] \"Land Use Change Emission (future)\"                         \n[55] \"Land Use Change Emission (future)\"                         \n[56] \"Land Use Change Emission (future)\"                         \n[57] \"Land Use Change Emission (future)\"                         \n[58] \"Land Use Change Emission (future)\"                         \n[59] \"Land Use Change Emission (future)\"                         \n[60] \"Land Use Change Emission (future)\"                         \n[61] \"meat and dairy production by tech\"                         \n[62] \"nonCO2 emissions by resource production\"                   \n[63] \"nonCO2 emissions by resource production\"                   \n[64] \"nonCO2 emissions by resource production\"                   \n[65] \"nonCO2 emissions by resource production\"                   \n[66] \"nonCO2 emissions by sector\"                                \n[67] \"nonCO2 emissions by sector\"                                \n[68] \"nonCO2 emissions by sector\"                                \n[69] \"nonCO2 emissions by sector\"                                \n[70] \"nonCO2 emissions by sector\"                                \n[71] \"nonCO2 emissions by sector USA\"                            \n[72] \"nonCO2 emissions by sector USA\"                            \n[73] \"nonCO2 emissions by sector USA\"                            \n[74] \"nonCO2 emissions by sector USA\"                            \n[75] \"nonCO2 emissions by subsector\"                             \n[76] \"nonCO2 emissions by subsector\"                             \n[77] \"outputs by tech\"                                           \n[78] \"Population by region\"                                      \n[79] \"prices by sector\"                                          \n[80] \"primary energy consumption by region (direct equivalent)\"  \n[81] \"refined liquids production by subsector\"                   \n[82] \"total final energy by aggregate sector\"                    \n[83] \"total final energy by sector\"                              \n[84] \"transport final energy by fuel\"                            \n[85] \"transport final energy by mode and fuel\"                   \n[86] \"transport service output by mode\"                          \n[87] \"transport service output by tech\"                          \n[88] \"transport service output by tech (new)\"                    \n[89] \"water consumption by state, sector, basin (includes desal)\"\n[90] \"water consumption by water mapping source\"                 \n[91] \"water withdrawals by crop\"                                 \n[92] \"water withdrawals by state, sector, basin (includes desal)\"\n[93] \"water withdrawals by water mapping source\"                 \n[94] \"Water withdrawals by water source (runoff vs. groundwater)\"\n```\n:::\n\n```{.r .cell-code}\n#gcamextractor::map_param_query # Get a table of params and the relevants queries used to extract and calculate them.\n\n#dataGCAM <- gcamextractor::readgcam(gcamdatabase = path_to_gcam_database,\n#                                    paramsSelect = c(\"emissCO2BySector\", \"emissCO2BySectorNoBio\"), \n#                                    folder = \"test_folder\")\n```\n:::\n\n\n-   line charts\n\n## failure\n\n-   run a model with `transportation_UCD_CORE.xml`(default file in GCAM7.0) -\\> worked!\n\n-   run a model with `transportation_UCD_CORE_CurPol_KOREA_Dawoon.xml` -\\> error!\n\n::: callout-important\n## erorr message\n\n-   Unknown tag: loadFactor encountered while processing period\\\n-   Market info object cannot be returned because market H2 enduse in XX does not exit\\\n-   Called for price of non-existant market H2 enduse in region XX\\\n:::\n\n### Let's cheack the difference btw dac_ssp2 and dap_ssp2_x3 scenario\n\n:::{.call-out:note} \\## common value applied for two dac_ssp2 & dap_ssp2_x3 comparison\n\n-   <Value name = \"1p5\">../input/Korea/1p5-incr-UC-kor-LUC-Kwangnam.xml</Value> \n-   <Value name = \"GHG_link_Korea\">../input/Korea/GHG_link_Kor.xml</Value> \\\n-   <Value name = \"world_deeper_decarbonization_2050\">../input/Korea/FFI-const-row-deeper-decarb-2050-1p5-6000-Linear.xml</Value> \\\n-   <Value name = \"GHG_link_row\">../input/Korea/PCT_CO2_LUC_link_p10_row.xml</Value>\\\n    :::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.3     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(gghighlight)\n\ndac_data<- read_excel('./KAIST_IAM_GROUP/results.xlsx')\n\ndata_tidy<- dac_data %>% \n    select(-scenario, -region) %>% \n    relocate(type, query) %>% \n    pivot_longer(-c('type', 'query', 'sector'), names_to =\"year\", values_to = \"MTC\") %>% \n    mutate( year = as.numeric(year))\n\ndata_tidy %>% \n    filter(query == \"sequestration\") %>% \n    ggplot(aes(x= year, y = MTC, group = sector, color = type))+\n    geom_line()+\n    facet_wrap(~sector)+\n    labs(title= \"Comparison between scenario dap_ssp2 and dap_ssp_x3\")\n```\n\n::: {.cell-output-display}\n![](KAIST_IAM_GROUP_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\ndata_tidy %>% \n    filter(query == \"emission\") %>% \n    ggplot(aes(x= year, y = MTC, group = sector, color = type))+\n    geom_line()+\n    facet_wrap(~type)+\n    labs(title= \"Comparison between scenario dap_ssp2 and dap_ssp_x3\")\n```\n\n::: {.cell-output-display}\n![](KAIST_IAM_GROUP_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n:::\n\n\n### Results \n\n-   I used `library(gcamextractor)` to ease data manipulation burden and make the difference more visible.\n\n-   the results from two scenarios showed no big differences (the results are almost identical)\n\n-   We can also see from the figure below that it seems like there is only one scenario not two.\n\n![](KAIST_IAM_GROUP/withBio.png)\n\n![](KAIST_IAM_GROUP/noBio.png)\n",
    "supporting": [
      "KAIST_IAM_GROUP_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}